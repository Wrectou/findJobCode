<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>jsCode</title>
</head>
<body>
  <script>
    
    /* // 提供了一个数组结构的data，要求实现一个query方法，返回一个新的数组。
    // query方法内部有过滤、排序、分组等操作，并且支持链式调用。调用最终的execute方法返回结果。
    const list = [
      { id: 2, name: 'zhangsan', age: 20, group: "jishu" },
      { id: 1, name: 'lisi', age: 11, group: "jishu" },
      { id: 6, name: 'wanger', age: 25, group: "yunying" },
      { id: 3, name: 'mazi', age: 30, group: "yunying" },
      { id: 5, name: 'hh', age: 19, group: "yunying" },
      { id: 9, name: 'hr', age: 33, group: "hr" },
    ]

    class Utils {
      constructor(list) {
        this.list = list
      }
      query() {
        console.log("query", this, this.list);
      }
      where(fn) {
        this.list = this.list.filter(fn)
        return this
      }
      sortBy(key) {
        this.list.sort((a, b) => a[key] - b[key])
        return this
      }
      groupBy(key) {
        let arr = []
        let obj = {}
        this.list.forEach(item => {
          if (obj[item.group]) {
            obj[item.group].list.push(item)
          } else {
            obj[item.group] = {}
            obj[item.group].id = item.id
            obj[item.group].list = [item]
          }
        })
        // console.log(obj);
        for (let key in obj) {
          // console.log(obj[key]);
          arr.push(obj[key].list)
        }
        // console.log(arr);
        this.list = arr
        return this
      }
      execute() {
        return this.list
      }
    }

    const result = new Utils(list)
    result
      .where(item => item.age > 18)
      .sortBy("id")
      .groupBy("group")
      .execute()
    console.log(result);
     */

    /* function query(list) {
      return {
        where(fn) {
          list = list.filter(fn)
          return this
        },
        sortBy(key) {
          list.sort((a, b) => a[key] - b[key])
          return this
        },
        groupBy(key) {
          let arr = []
          let obj = {}
          list.forEach(item => {
            if (obj[item.group]) {
              obj[item.group].list.push(item)
            } else {
              obj[item.group] = {}
              obj[item.group].id = item.id
              obj[item.group].list = [item]
            }
          })
          // console.log(obj);
          for (let key in obj) {
            // console.log(obj[key]);
            arr.push(obj[key].list)
          }
          // console.log(arr);
          list = arr
          return this
        },
        execute() {
          return list
        }
      }
    }

    const list = [
      { id: 2, name: 'zhangsan', age: 20, group: "jishu" },
      { id: 1, name: 'lisi', age: 11, group: "jishu" },
      { id: 6, name: 'wanger', age: 25, group: "yunying" },
      { id: 3, name: 'mazi', age: 30, group: "yunying" },
      { id: 5, name: 'hh', age: 19, group: "yunying" },
      { id: 9, name: 'hr', age: 33, group: "hr" },
    ]
    const result = query(list)
      .where(item => item.age > 18)
      .sortBy('id')
      .groupBy('name')
      .execute();

    console.log(result); */




    
    /* // Event Loop
    [1, 2, 3, 4].forEach(function(i) {
      console.log(i);
    })

    function asyncForEach(arr, cb) {
      arr.forEach(function(i) {
        setTimeout(cb, 0)
        // setTimeout(() => {
        //   cb(i)
        // }, 1000)
      })
    }

    asyncForEach([1, 2, 3, 4], function(i) {
      console.log(i);
    }) */


  </script>
</body>
</html>