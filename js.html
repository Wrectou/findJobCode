<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <meta http-equiv="Cache-Control" content="no-cache"> -->
  <!-- <meta http-equiv="Cache" content="no-cache"> -->
  <!-- <meta http-equiv="Pragma" content="no-cache"> -->
  <title>jsCode</title>
  <!-- <link rel="stylesheet" href="./a.css"> -->
</head>
<body>
  <script>
    
    /* // 提供了一个数组结构的data，要求实现一个query方法，返回一个新的数组。
    // query方法内部有过滤、排序、分组等操作，并且支持链式调用。调用最终的execute方法返回结果。
    const list = [
      { id: 2, name: 'zhangsan', age: 20, group: "jishu" },
      { id: 1, name: 'lisi', age: 11, group: "jishu" },
      { id: 6, name: 'wanger', age: 25, group: "yunying" },
      { id: 3, name: 'mazi', age: 30, group: "yunying" },
      { id: 5, name: 'hh', age: 19, group: "yunying" },
      { id: 9, name: 'hr', age: 33, group: "hr" },
    ]

    class Utils {
      constructor(list) {
        this.list = list
      }
      query() {
        console.log("query", this, this.list);
      }
      where(fn) {
        this.list = this.list.filter(fn)
        return this
      }
      sortBy(key) {
        this.list.sort((a, b) => a[key] - b[key])
        return this
      }
      groupBy(key) {
        let arr = []
        let obj = {}
        this.list.forEach(item => {
          if (obj[item.group]) {
            obj[item.group].list.push(item)
          } else {
            obj[item.group] = {}
            obj[item.group].id = item.id
            obj[item.group].list = [item]
          }
        })
        // console.log(obj);
        for (let key in obj) {
          // console.log(obj[key]);
          arr.push(obj[key].list)
        }
        // console.log(arr);
        this.list = arr
        return this
      }
      execute() {
        return this.list
      }
    }

    const result = new Utils(list)
    result
      .where(item => item.age > 18)
      .sortBy("id")
      .groupBy("group")
      .execute()
    console.log(result);
     */


    /* // Array.prototype.myFilter = function(fn) {
    //   let arr = []
    //   for(let i = 0; i < this.length; i++) {
    //     if (fn(this[i])) arr.push(this[i])
    //   }
    //   return arr
    // }
    
    function query(list) {
      return {
        where(fn) {
          list = list.filter(fn)
          return this
        },
        sortBy(key) {
          list.sort((a, b) => a[key] - b[key])
          return this
        },
        groupBy(key) {
          let arr = []
          let obj = {}
          list.forEach(item => {
            if (obj[item.group]) {
              obj[item.group].list.push(item)
            } else {
              obj[item.group] = {}
              obj[item.group].id = item.id
              obj[item.group].list = [item]
            }
          })
          // console.log(obj);
          for (let key in obj) {
            // console.log(obj[key]);
            arr.push(obj[key].list)
          }
          // console.log(arr);
          list = arr
          return this
        },
        execute() {
          return list
        }
      }
    }

    const list = [
      { id: 2, name: 'zhangsan', age: 20, group: "jishu" },
      { id: 1, name: 'lisi', age: 11, group: "jishu" },
      { id: 6, name: 'wanger', age: 25, group: "yunying" },
      { id: 3, name: 'mazi', age: 30, group: "yunying" },
      { id: 5, name: 'hh', age: 19, group: "yunying" },
      { id: 9, name: 'hr', age: 33, group: "hr" },
    ]
    const result = query(list)
      .where(item => item.age > 18)
      .sortBy('id')
      .groupBy('name')
      .execute();

    console.log(result);
 */

    
    /* // Event Loop
    [1, 2, 3, 4].forEach(function(i) {
      console.log(i);
    })

    function asyncForEach(arr, cb) {
      arr.forEach(function(i) {
        setTimeout(cb, 0)
        // setTimeout(() => {
        //   cb(i)
        // }, 1000)
      })
    }

    asyncForEach([1, 2, 3, 4], function(i) {
      console.log(i);
    }) */


    /* // deepClone
    var obj = {
      name: "zhangsan",
      age: 22,
      hh: {
        ad: "dsdsd",
        sdads: null,
      },
      dasd: {
        hh: false,
        ddd: {
          g4ggf: "dssdsdsd",
          aarr1: [1,2,3,4,"3"],
          jdter: true,
          cww: undefined,
        },
        opp: 123
      },
      cc: function() {
        console.log(this.name);
      },
      arr: [1,2,[12],3,["1","2","3"]]
    };
    console.log(obj);
    Object.prototype.protohhh = "dsad"
    // var obj1 = JSON.parse(JSON.stringify(obj));


    function deepClone(origin, target = {}) {
      if (typeof origin === "object" && origin !== null) {
        for (let key in origin) {
          if (origin.hasOwnProperty(key)) {
            if (typeof origin[key] === "object") {
              target[key] = deepClone(origin[key], Array.isArray(origin[key]) ? [] : {})
            } else {
              target[key] = origin[key]
            }
          }
        }
      }
      return target
    }
    var obj1 = deepClone(obj)
    // console.log(obj1);
    // obj.cc()
    // obj1.name = "aaa"
    // obj1.cc()
    // console.log(obj == obj1, obj.dasd === obj1.dasd);
    // console.log(obj.dasd.ddd.aarr1 === obj1.dasd.ddd.aarr1);
    // obj.dasd.ddd.aarr1.push(111)
    // console.log(obj.dasd.ddd.aarr1 === obj1.dasd.ddd.aarr1); */

    
    /* Array.prototype.myFlat = function() {
      let arr = []
      for(let i = 0; i < this.length; i++) {
        if (Object.prototype.toString.call(this[i]) === "[object Array]") {
          arr = arr.concat(this[i].myFlat())
        } else {
          arr.push(this[i])
        }
      }
      return arr
    }
    var arr = [1,2,[3,4],5,6,[7,8,[9,10,3],11,4],12,1,2,3]
    console.log(arr, arr.myFlat()); */


    /* // 微软面试题 给定包含数字2-9的字符串，返回所对应所有字母组合
    function keyboardMap(digits) {
      var telephoneNumberAbcArr = ["", "", "abc", "def", "ghi", "jkl", "mno", "pqrs", "tuv", "wxyz"];
      var result = [];
      for (let i = 0; i < digits.length; i++) {
        console.log(digits, digits[i], telephoneNumberAbcArr[digits[i]]);
        result = [...compose(result, telephoneNumberAbcArr[digits[i]])];
      }
      function compose(arr1, arr2) {
        var r = [];
        if (arr1.length < 1) return [...arr2];
        if (arr2.length < 1) return [...arr1];
        for (let i = 0; i < arr1.length; i++) {
          for (let j = 0; j < arr2.length; j++) {
            r.push(arr1[i] + arr2[j]);
          }
        }
        return r;
      }
      return result;
    }
    console.log(keyboardMap("9527")); */


    /* // 值和引用 下面代码输出什么（字节）
    var foo = { bar: 1 };
    var arr1 = [1, 2, foo];
    var arr2 = arr1.slice(1);
    arr2[0]++;
    arr2[1].bar++;
    foo.bar++;
    arr1[2].bar++;
    console.log(arr1[1] === arr2[0]);
    console.log(arr1[2] === arr2[1]);
    console.log(foo.bar); */


    /* // 连续赋值 阿里面试题
    var a = { n: 1 };
    var b = a;
    a.x = a = { n: 2 };
    // 不会 赋值运算，先定义左边的 a.x，在运算后面的整体 a = { n: 2 }
    console.log(a.x);
    console.log(b.x); */


    /* // 奇数求和 写个函数求从1开始的前n个基数的和
    function sum(n) {
      // let result = 0;
      // for (let i = 0; i < n; i++) {
      //   result += 2 * i + 1;
      // }
      // return result;
      // return Math.pow(n, 2);
      // return n * n;
    }
    console.log(sum(1));
    console.log(sum(2));
    console.log(sum(3));
    console.log(sum(4));
    console.log(sum(5));
    console.log(sum(6));
    console.log(sum(7));
    //  1 3 5 7 9 11 13 15
    //  1 4 9 16 25 36 49 64 */


    /* // 下面代码的输出结果是什么？ 对象赋值操作
    const obj = {
      a: 0,
    };
    obj["1"] = 0;
    obj[++obj.a] = obj.a++;
    const values = Object.values(obj);
    obj[values[1]] = obj.a;
    console.log(obj); */
    

    /* // for in 循环会遍历原型链, 如何避免原型链属性被遍历？
    // Object.prototype.c = "333";
    Object.defineProperty(Object.prototype, "c", {
      value: "333",
      enumerable: false,
      configurable: true,
      writable: true,
    });
    const obj = {
      a: 1,
      b: 2
    }
    for (let key in obj) {
      console.log(key);
    }
    console.log(obj);
    console.log(Object.getOwnPropertyDescriptor(Object.prototype, "c")); */


    /* // ++ -- 运算符，优先级大于 * /
    var a = 1;
    var b = a++ + ++a * a++;
    console.log(a, b);

    var c = 2;
    c = c++;
    console.log(c);

    var d = 10;
    d = d--;
    var e = d++ + c + --c * d--;
    console.log(d, e); */


  </script>
  <!-- <script src="./a.js"></script> -->
</body>
</html>